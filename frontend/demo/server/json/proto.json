{
  "id": "proto",
  "routes": {
    "list": [
      {
        "path": "/proto",
        "exact": true,
        "isOtherPage": false
      },
      {
        "path": "/proto/patients",
        "exact": true,
        "isOtherPage": false
      },
      {
        "path": "/proto/patients/:proto_patients_id",
        "exact": true,
        "isOtherPage": false
      },
      {
        "path": "/proto/patients/create",
        "exact": true,
        "isOtherPage": true
      },
      {
        "path": "/proto/patients/:proto_patients_id/update",
        "exact": true,
        "isOtherPage": true
      },
      {
        "path": "/proto/patients/:proto_patients_id/update2",
        "exact": true,
        "isOtherPage": true
      },
      {
        "path": "/proto/patients/:proto_patients_id/view",
        "exact": true,
        "isOtherPage": true
      },
      {
        "path": "/proto/patients/:proto_patients_id/surname",
        "exact": true,
        "isOtherPage": true
      },
      {
        "path": "/proto/patients/:proto_patients_id/name",
        "exact": true,
        "isOtherPage": true
      },
      {
        "path": "/proto/patients/:proto_patients_id/update",
        "exact": true,
        "isOtherPage": true
      },
      {
        "path": "/proto/patients/:proto_patients_id/contacts",
        "exact": true,
        "isOtherPage": false
      },
      {
        "path": "/proto/patients/:proto_patients_id/contacts/:proto_contacts_id",
        "exact": true,
        "isOtherPage": false
      },
      {
        "path": "/proto/patients/:proto_patients_id/contacts/create",
        "exact": true,
        "isOtherPage": true
      },
      {
        "path": "/proto/patients/:proto_patients_id/contacts/:proto_contacts_id/update",
        "exact": true,
        "isOtherPage": true
      },
      {
        "path": "/proto/patients/:patient_id/card",
        "exact": true,
        "isOtherPage": false
      },
      {
        "path": "/proto/patients/:patient_id/card/:proto_form_id",
        "exact": true,
        "isOtherPage": false
      }
    ],
    "pathMapping": {
      "proto_patients_id": {
        "type": "n2o/widgets/CHANGE_SELECTED_ID",
        "payload": {
          "widgetId": "proto_patients",
          "value": ":proto_patients_id"
        }
      },
      "proto_contacts_id": {
        "type": "n2o/widgets/CHANGE_SELECTED_ID",
        "payload": {
          "widgetId": "proto_contacts",
          "value": ":proto_contacts_id"
        }
      },
      "patient_id": {
        "type": "n2o/widgets/CHANGE_SELECTED_ID",
        "payload": {
          "widgetId": "proto_patients",
          "value": ":patient_id"
        }
      },
      "proto_form_id": {
        "type": "n2o/widgets/CHANGE_SELECTED_ID",
        "payload": {
          "widgetId": "proto_form",
          "value": ":proto_form_id"
        }
      }
    },
    "queryMapping": {
      "proto_patients_surname": {
        "get": {
          "type": "n2o/models/UPDATE",
          "payload": {
            "prefix": "filter",
            "key": "proto_patients",
            "field": "surname",
            "value": ":proto_patients_surname"
          }
        },
        "set": {
          "value": "`surname`",
          "link": "models.filter['proto_patients']"
        }
      },
      "proto_patients_name": {
        "get": {
          "type": "n2o/models/UPDATE",
          "payload": {
            "prefix": "filter",
            "key": "proto_patients",
            "field": "name",
            "value": ":proto_patients_name"
          }
        },
        "set": {
          "value": "`name`",
          "link": "models.filter['proto_patients']"
        }
      },
      "proto_patients_bdate_end": {
        "get": {
          "type": "n2o/models/UPDATE",
          "payload": {
            "prefix": "filter",
            "key": "proto_patients",
            "field": "bdate.end",
            "value": ":proto_patients_bdate_end"
          }
        },
        "set": {
          "value": "`bdate.end`",
          "link": "models.filter['proto_patients']"
        }
      },
      "proto_patients_bdate_begin": {
        "get": {
          "type": "n2o/models/UPDATE",
          "payload": {
            "prefix": "filter",
            "key": "proto_patients",
            "field": "bdate.begin",
            "value": ":proto_patients_bdate_begin"
          }
        },
        "set": {
          "value": "`bdate.begin`",
          "link": "models.filter['proto_patients']"
        }
      },
      "proto_patients_genders_id": {
        "get": {
          "type": "n2o/models/UPDATE_MAP",
          "payload": {
            "prefix": "filter",
            "key": "proto_patients",
            "field": "genders",
            "value": ":proto_patients_genders_id",
            "map": "id"
          }
        },
        "set": {
          "value": "`genders.map(function(t){return t.id})`",
          "link": "models.filter['proto_patients']"
        }
      },
      "proto_patients_vip": {
        "get": {
          "type": "n2o/models/UPDATE",
          "payload": {
            "prefix": "filter",
            "key": "proto_patients",
            "field": "vip",
            "value": ":proto_patients_vip"
          }
        },
        "set": {
          "value": "`vip`",
          "link": "models.filter['proto_patients']"
        }
      },
      "sorting_patients_surname": {
        "get": {
          "type": "n2o/widgets/SORT_BY",
          "payload": {
            "widgetId": "proto_patients",
            "fieldKey": "surname",
            "sortDirection": ":sorting_patients_surname"
          }
        },
        "set": {
          "link": "widgets['proto_patients'].sorting.surname"
        }
      },
      "sorting_patients_name": {
        "get": {
          "type": "n2o/widgets/SORT_BY",
          "payload": {
            "widgetId": "proto_patients",
            "fieldKey": "name",
            "sortDirection": ":sorting_patients_name"
          }
        },
        "set": {
          "link": "widgets['proto_patients'].sorting.name"
        }
      },
      "sorting_patients_patrName": {
        "get": {
          "type": "n2o/widgets/SORT_BY",
          "payload": {
            "widgetId": "proto_patients",
            "fieldKey": "patrName",
            "sortDirection": ":sorting_patients_patrName"
          }
        },
        "set": {
          "link": "widgets['proto_patients'].sorting.patrName"
        }
      },
      "sorting_patients_birthday": {
        "get": {
          "type": "n2o/widgets/SORT_BY",
          "payload": {
            "widgetId": "proto_patients",
            "fieldKey": "birthday",
            "sortDirection": ":sorting_patients_birthday"
          }
        },
        "set": {
          "link": "widgets['proto_patients'].sorting.birthday"
        }
      },
      "sorting_patients_age": {
        "get": {
          "type": "n2o/widgets/SORT_BY",
          "payload": {
            "widgetId": "proto_patients",
            "fieldKey": "age",
            "sortDirection": ":sorting_patients_age"
          }
        },
        "set": {
          "link": "widgets['proto_patients'].sorting.age"
        }
      },
      "proto_contacts_type_id": {
        "get": {
          "type": "n2o/models/UPDATE",
          "payload": {
            "prefix": "filter",
            "key": "proto_contacts",
            "field": "type.id",
            "value": ":proto_contacts_type_id"
          }
        },
        "set": {
          "value": "`type.id`",
          "link": "models.filter['proto_contacts']"
        }
      },
      "sorting_contacts_value": {
        "get": {
          "type": "n2o/widgets/SORT_BY",
          "payload": {
            "widgetId": "proto_contacts",
            "fieldKey": "value",
            "sortDirection": ":sorting_contacts_value"
          }
        },
        "set": {
          "link": "widgets['proto_contacts'].sorting.value"
        }
      },
      "sorting_form_surname": {
        "get": {
          "type": "n2o/widgets/SORT_BY",
          "payload": {
            "widgetId": "proto_form",
            "fieldKey": "surname",
            "sortDirection": ":sorting_form_surname"
          }
        },
        "set": {
          "link": "widgets['proto_form'].sorting.surname"
        }
      },
      "sorting_form_name": {
        "get": {
          "type": "n2o/widgets/SORT_BY",
          "payload": {
            "widgetId": "proto_form",
            "fieldKey": "name",
            "sortDirection": ":sorting_form_name"
          }
        },
        "set": {
          "link": "widgets['proto_form'].sorting.name"
        }
      },
      "sorting_form_patrName": {
        "get": {
          "type": "n2o/widgets/SORT_BY",
          "payload": {
            "widgetId": "proto_form",
            "fieldKey": "patrName",
            "sortDirection": ":sorting_form_patrName"
          }
        },
        "set": {
          "link": "widgets['proto_form'].sorting.patrName"
        }
      },
      "sorting_form_birthday": {
        "get": {
          "type": "n2o/widgets/SORT_BY",
          "payload": {
            "widgetId": "proto_form",
            "fieldKey": "birthday",
            "sortDirection": ":sorting_form_birthday"
          }
        },
        "set": {
          "link": "widgets['proto_form'].sorting.birthday"
        }
      },
      "sorting_form_age": {
        "get": {
          "type": "n2o/widgets/SORT_BY",
          "payload": {
            "widgetId": "proto_form",
            "fieldKey": "age",
            "sortDirection": ":sorting_form_age"
          }
        },
        "set": {
          "link": "widgets['proto_form'].sorting.age"
        }
      }
    }
  },
  "widgets": {
    "proto_patients": {
      "src": "TableWidget",
      "dataProvider": {
        "url": "n2o/data/proto/patients",
        "pathMapping": {},
        "queryMapping": {
          "proto_patients_surname": {
            "value": "`surname`",
            "link": "models.filter['proto_patients']"
          },
          "proto_patients_name": {
            "value": "`name`",
            "link": "models.filter['proto_patients']"
          },
          "proto_patients_bdate_end": {
            "value": "`bdate.end`",
            "link": "models.filter['proto_patients']"
          },
          "proto_patients_bdate_begin": {
            "value": "`bdate.begin`",
            "link": "models.filter['proto_patients']"
          },
          "proto_patients_genders_id": {
            "value": "`genders.map(function(t){return t.id})`",
            "link": "models.filter['proto_patients']"
          },
          "proto_patients_vip": {
            "value": "`vip`",
            "link": "models.filter['proto_patients']"
          }
        }
      },
      "toolbar": {
        "topLeft": [
          {
            "id": "topLeft0",
            "buttons": [
              {
                "id": "create",
                "icon": "fa fa-plus",
                "actionId": "create",
                "hint": "Создать",
                "conditions": {},
                "title": "Создать"
              },
              {
                "id": "update",
                "icon": "fa fa-pencil",
                "actionId": "update",
                "hint": "Изменить",
                "conditions": {
                  "enabled": [
                    {
                      "expression": "!_.isEmpty(this)",
                      "modelLink": "models.resolve['proto_patients']"
                    }
                  ]
                },
                "title": "Изменить"
              },
              {
                "id": "delete",
                "actionId": "delete",
                "hint": "Удалить",
                "conditions": {
                  "enabled": [
                    {
                      "expression": "!_.isEmpty(this)",
                      "modelLink": "models.resolve['proto_patients']"
                    }
                  ]
                },
                "confirm": {
                  "text": "Вы уверены, что хотите удалить пациента '{surname}'?",
                  "title": "Предупреждение",
                  "okLabel": "Да",
                  "cancelLabel": "Нет"
                },
                "title": "Удалить"
              }
            ]
          }
        ],
        "topRight": [
          {
            "id": "topRight0",
            "buttons": [
              {
                "id": "update2",
                "icon": "fa fa-edit",
                "actionId": "update2",
                "hint": "Кнопка скрывается, если в строке имя Мария",
                "conditions": {
                  "enabled": [
                    {
                      "expression": "!_.isEmpty(this)",
                      "modelLink": "models.resolve['proto_patients']"
                    }
                  ],
                  "visible": [
                    {
                      "expression": "name!='Мария'",
                      "modelLink": "models.resolve['proto_patients']"
                    }
                  ]
                },
                "color": "light"
              },
              {
                "id": "view",
                "icon": "fa fa-book",
                "actionId": "view",
                "hint": "Кнопка блокируется, если в фильтре имя Анна",
                "conditions": {
                  "enabled": [
                    {
                      "expression": "name!='Анна'",
                      "modelLink": "models.resolve['proto_patients']"
                    },
                    {
                      "expression": "!_.isEmpty(this)",
                      "modelLink": "models.resolve['proto_patients']"
                    }
                  ]
                },
                "color": "info",
                "title": "Просмотр"
              }
            ]
          }
        ],
        "bottomRight": [
          {
            "id": "bottomRight0",
            "buttons": [
              {
                "id": "menuItem5",
                "icon": "fa fa-filter",
                "actionId": "menuItem5",
                "hint": "Изменить видимость фильтров",
                "conditions": {}
              },
              {
                "id": "menuItem6",
                "icon": "fa fa-table",
                "hint": "Изменить видимость колонок",
                "conditions": {},
                "dropdownSrc": "ToggleColumn"
              },
              {
                "id": "menuItem7",
                "icon": "fa fa-refresh",
                "actionId": "menuItem7",
                "hint": "Обновить данные",
                "conditions": {}
              },
              {
                "id": "menuItem8",
                "icon": "fa fa-bars",
                "hint": "Изменить размер",
                "conditions": {},
                "dropdownSrc": "ChangeSize"
              }
            ]
          }
        ]
      },
      "actions": {
        "create": {
          "id": "create",
          "src": "perform",
          "options": {
            "type": "n2o/modals/INSERT",
            "payload": {
              "name": "proto_patients_create",
              "pageId": "proto_patients_create",
              "pageUrl": "/proto/patients/create",
              "pathMapping": {},
              "queryMapping": {},
              "closeButton": true,
              "visible": true
            }
          }
        },
        "update": {
          "id": "update",
          "src": "perform",
          "options": {
            "type": "n2o/modals/INSERT",
            "payload": {
              "name": "proto_patients_update",
              "pageId": "proto_patients_update",
              "pageUrl": "/proto/patients/:proto_patients_id/update",
              "pathMapping": {
                "proto_patients_id": {
                  "link": "models.resolve['proto_patients'].id"
                }
              },
              "queryMapping": {},
              "closeButton": true,
              "visible": true
            }
          }
        },
        "delete": {
          "id": "delete",
          "src": "perform",
          "options": {
            "type": "n2o/actionImpl/START_INVOKE",
            "payload": {
              "widgetId": "proto_patients",
              "dataProvider": {
                "url": "n2o/data/proto/patients/:proto_patients_id/delete",
                "pathMapping": {
                  "proto_patients_id": {
                    "link": "models.resolve['proto_patients'].id"
                  }
                },
                "method": "POST"
              },
              "modelLink": "models.resolve['proto_patients']"
            },
            "meta": {
              "success": {
                "refresh": {
                  "type": "widget",
                  "options": {
                    "widgetId": "proto_patients"
                  }
                }
              },
              "fail": {}
            }
          }
        },
        "update2": {
          "id": "update2",
          "src": "link",
          "options": {
            "path": "/proto/patients/:proto_patients_id/update2",
            "target": "application",
            "pathMapping": {
              "proto_patients_id": {
                "link": "models.resolve['proto_patients'].id"
              }
            },
            "queryMapping": {}
          }
        },
        "view": {
          "id": "view",
          "src": "perform",
          "options": {
            "type": "n2o/modals/INSERT",
            "payload": {
              "name": "proto_patients_view",
              "pageId": "proto_patients_view",
              "pageUrl": "/proto/patients/:proto_patients_id/view",
              "pathMapping": {
                "proto_patients_id": {
                  "link": "models.resolve['proto_patients'].id"
                }
              },
              "queryMapping": {},
              "closeButton": true,
              "visible": true
            }
          }
        },
        "menuItem5": {
          "id": "menuItem5",
          "src": "perform",
          "options": {
            "payload": {
              "widgetId": "proto_patients"
            },
            "type": "n2o/widgets/TOGGLE_FILTER_VISIBILITY"
          }
        },
        "menuItem7": {
          "id": "menuItem7",
          "src": "perform",
          "options": {
            "type": "n2o/widgets/DATA_REQUEST",
            "payload": {
              "widgetId": "proto_patients"
            }
          }
        },
        "surname": {
          "id": "surname",
          "src": "link",
          "options": {
            "path": "/proto/patients/:proto_patients_id/surname",
            "target": "application",
            "pathMapping": {
              "proto_patients_id": {
                "link": "models.resolve['proto_patients'].id"
              }
            },
            "queryMapping": {}
          }
        },
        "name": {
          "id": "name",
          "src": "perform",
          "options": {
            "type": "n2o/modals/INSERT",
            "payload": {
              "name": "proto_patients_name",
              "pageId": "proto_patients_name",
              "pageUrl": "/proto/patients/:proto_patients_id/name",
              "pathMapping": {
                "proto_patients_id": {
                  "link": "models.resolve['proto_patients'].id"
                }
              },
              "queryMapping": {},
              "closeButton": true,
              "visible": true
            }
          }
        },
        "patrName": {
          "id": "patrName",
          "src": "link",
          "options": {
            "path": "/patients/:id/update2",
            "target": "application",
            "pathMapping": {
              "id": {
                "value": "`id`",
                "link": "models.resolve['proto_patients']"
              }
            },
            "queryMapping": {}
          }
        },
        "vip": {
          "id": "vip",
          "src": "perform",
          "options": {
            "type": "n2o/actionImpl/START_INVOKE",
            "payload": {
              "widgetId": "proto_patients",
              "dataProvider": {
                "url": "n2o/data/proto/patients/:proto_patients_id/vip",
                "pathMapping": {
                  "proto_patients_id": {
                    "link": "models.resolve['proto_patients'].id"
                  }
                },
                "method": "POST"
              },
              "modelLink": "models.resolve['proto_patients']"
            },
            "meta": {
              "success": {
                "refresh": {
                  "type": "widget",
                  "options": {
                    "widgetId": "proto_patients"
                  }
                }
              },
              "fail": {}
            }
          }
        }
      },
      "paging": {
        "size": 10
      },
      "filter": {
        "filterFieldsets": [
          {
            "src": "StandardFieldset",
            "rows": [
              {
                "cols": [
                  {
                    "fields": [
                      {
                        "id": "surname",
                        "src": "StandardField",
                        "label": "Фамилия",
                        "dependency": [],
                        "control": {
                          "src": "InputText"
                        }
                      }
                    ]
                  },
                  {
                    "fields": [
                      {
                        "id": "name",
                        "src": "StandardField",
                        "label": "Имя",
                        "dependency": [],
                        "control": {
                          "src": "InputText"
                        }
                      }
                    ]
                  },
                  {
                    "fields": [
                      {
                        "id": "bdate",
                        "src": "StandardField",
                        "label": "Дата рождения",
                        "dependency": [],
                        "control": {
                          "src": "DateInterval",
                          "outputFormat": "DD.MM.YYYY HH:mm:ss"
                        }
                      }
                    ]
                  }
                ]
              },
              {
                "cols": [
                  {
                    "fields": [
                      {
                        "id": "genders",
                        "src": "StandardField",
                        "label": "Пол",
                        "dependency": [],
                        "control": {
                          "valueFieldId": "id",
                          "labelFieldId": "name",
                          "hasSearch": false,
                          "dataProvider": {
                            "url": "n2o/data/ProtoGender",
                            "queryMapping": {},
                            "quickSearchParam": "name"
                          },
                          "label": "Пол",
                          "inline": true,
                          "type": "n2o",
                          "src": "CheckboxGroup"
                        }
                      }
                    ],
                    "size": 10
                  },
                  {
                    "fields": [
                      {
                        "id": "vip",
                        "src": "StandardField",
                        "dependency": [],
                        "control": {
                          "label": "VIP",
                          "src": "Checkbox"
                        }
                      }
                    ]
                  }
                ]
              }
            ]
          }
        ],
        "filterButtonId": "filter",
        "blackResetList": [],
        "filterPlace": "top",
        "searchButtons": true,
        "validation": {}
      },
      "table": {
        "fetchOnInit": true,
        "size": 10,
        "autoFocus": true,
        "hasFocus": true,
        "cells": [
          {
            "id": "surname",
            "fieldKey": "surname",
            "src": "LinkCell",
            "actionId": "surname",
            "action": {
              "id": "surname",
              "src": "link",
              "options": {
                "path": "/proto/patients/:proto_patients_id/surname",
                "target": "application",
                "pathMapping": {
                  "proto_patients_id": {
                    "link": "models.resolve['proto_patients'].id"
                  }
                },
                "queryMapping": {}
              }
            }
          },
          {
            "id": "name",
            "fieldKey": "name",
            "src": "LinkCell",
            "actionId": "name",
            "action": {
              "id": "name",
              "src": "perform",
              "options": {
                "type": "n2o/modals/INSERT",
                "payload": {
                  "name": "proto_patients_name",
                  "pageId": "proto_patients_name",
                  "pageUrl": "/proto/patients/:proto_patients_id/name",
                  "pathMapping": {
                    "proto_patients_id": {
                      "link": "models.resolve['proto_patients'].id"
                    }
                  },
                  "queryMapping": {},
                  "closeButton": true,
                  "visible": true
                }
              }
            }
          },
          {
            "id": "patrName",
            "fieldKey": "patrName",
            "src": "LinkCell",
            "actionId": "patrName",
            "action": {
              "id": "patrName",
              "src": "link",
              "options": {
                "path": "/patients/:id/update2",
                "target": "application",
                "pathMapping": {
                  "id": {
                    "value": "`id`",
                    "link": "models.resolve['proto_patients']"
                  }
                },
                "queryMapping": {}
              }
            }
          },
          {
            "id": "birthday",
            "fieldKey": "birthday",
            "src": "TextCell",
            "format": "date DD.MM.YYYY"
          },
          {
            "id": "genderName",
            "fieldKey": "genderName",
            "src": "BadgeCell",
            "color": "`gender.id==1?'danger':'success'`"
          },
          {
            "id": "vip",
            "fieldKey": "vip",
            "src": "CheckboxCell",
            "actionId": "vip",
            "readOnly": false,
            "action": {
              "id": "vip",
              "src": "perform",
              "options": {
                "type": "n2o/actionImpl/START_INVOKE",
                "payload": {
                  "widgetId": "proto_patients",
                  "dataProvider": {
                    "url": "n2o/data/proto/patients/:proto_patients_id/vip",
                    "pathMapping": {
                      "proto_patients_id": {
                        "link": "models.resolve['proto_patients'].id"
                      }
                    },
                    "method": "POST"
                  },
                  "modelLink": "models.resolve['proto_patients']"
                },
                "meta": {
                  "success": {
                    "refresh": {
                      "type": "widget",
                      "options": {
                        "widgetId": "proto_patients"
                      }
                    }
                  },
                  "fail": {}
                }
              }
            }
          },
          {
            "id": "",
            "fieldKey": "",
            "src": "ButtonsCell",
            "buttons": [
              {
                "id": "subMenu0",
                "icon": "fa fa-ellipsis-v",
                "conditions": {},
                "subMenu": [
                  {
                    "id": "delete",
                    "icon": "fa fa-trash",
                    "visible": true,
                    "actionId": "delete",
                    "action": {
                      "id": "delete",
                      "src": "perform",
                      "options": {
                        "type": "n2o/actionImpl/START_INVOKE",
                        "payload": {
                          "widgetId": "proto_patients",
                          "dataProvider": {
                            "url": "n2o/data/proto/patients/:proto_patients_id/delete",
                            "pathMapping": {
                              "proto_patients_id": {
                                "link": "models.resolve['proto_patients'].id"
                              }
                            },
                            "method": "POST"
                          },
                          "modelLink": "models.resolve['proto_patients']"
                        },
                        "meta": {
                          "success": {
                            "refresh": {
                              "type": "widget",
                              "options": {
                                "widgetId": "proto_patients"
                              }
                            }
                          },
                          "fail": {}
                        }
                      }
                    },
                    "hint": "Удалить",
                    "conditions": {
                      "enabled": [
                        {
                          "expression": "!_.isEmpty(this)",
                          "modelLink": "models.resolve['proto_patients']"
                        }
                      ]
                    },
                    "confirm": {
                      "text": "Вы уверены, что хотите удалить пациента '{surname}'?",
                      "title": "Предупреждение",
                      "okLabel": "Да",
                      "cancelLabel": "Нет"
                    },
                    "title": "Удалить"
                  },
                  {
                    "id": "update",
                    "icon": "fa fa-pencil",
                    "visible": true,
                    "actionId": "update",
                    "action": {
                      "id": "update",
                      "src": "perform",
                      "options": {
                        "type": "n2o/modals/INSERT",
                        "payload": {
                          "name": "proto_patients_update",
                          "pageId": "proto_patients_update",
                          "pageUrl": "/proto/patients/:proto_patients_id/update",
                          "pathMapping": {
                            "proto_patients_id": {
                              "link": "models.resolve['proto_patients'].id"
                            }
                          },
                          "queryMapping": {},
                          "closeButton": true,
                          "visible": true
                        }
                      }
                    },
                    "hint": "Изменить",
                    "conditions": {
                      "enabled": [
                        {
                          "expression": "!_.isEmpty(this)",
                          "modelLink": "models.resolve['proto_patients']"
                        }
                      ]
                    },
                    "title": "Изменить"
                  }
                ]
              }
            ]
          }
        ],
        "headers": [
          {
            "id": "surname",
            "label": "Фамилия",
            "src": "TextTableHeader",
            "sortable": true
          },
          {
            "id": "name",
            "label": "Имя",
            "src": "TextTableHeader",
            "sortable": true
          },
          {
            "id": "patrName",
            "label": "Отчество",
            "src": "TextTableHeader",
            "sortable": true
          },
          {
            "id": "birthday",
            "label": "Дата рождения",
            "src": "TextTableHeader",
            "sortable": true
          },
          {
            "id": "genderName",
            "label": "Пол",
            "src": "TextTableHeader",
            "sortable": false
          },
          {
            "id": "vip",
            "label": "VIP",
            "src": "TextTableHeader",
            "sortable": false
          },
          {
            "id": "",
            "src": "TextTableHeader"
          }
        ],
        "sorting": {
          "birthday": "ASC"
        },
        "hasSelect": true
      }
    },
    "proto_contacts": {
      "src": "TableWidget",
      "dataProvider": {
        "url": "n2o/data/proto/patients/:proto_patients_id/contacts",
        "pathMapping": {
          "proto_patients_id": {
            "link": "models.resolve['proto_patients'].id"
          }
        },
        "queryMapping": {
          "proto_contacts_type_id": {
            "value": "`type.id`",
            "link": "models.filter['proto_contacts']"
          }
        }
      },
      "toolbar": {
        "topLeft": [
          {
            "id": "topLeft0",
            "buttons": [
              {
                "id": "create",
                "icon": "fa fa-plus",
                "visible": true,
                "actionId": "create",
                "hint": "Создать",
                "conditions": {},
                "title": "Создать"
              },
              {
                "id": "update",
                "icon": "fa fa-pencil",
                "visible": true,
                "actionId": "update",
                "hint": "Изменить",
                "conditions": {
                  "enabled": [
                    {
                      "expression": "!_.isEmpty(this)",
                      "modelLink": "models.resolve['proto_contacts']"
                    }
                  ]
                },
                "title": "Изменить"
              },
              {
                "id": "delete",
                "icon": "fa fa-trash",
                "visible": true,
                "actionId": "delete",
                "hint": "Удалить",
                "conditions": {
                  "enabled": [
                    {
                      "expression": "!_.isEmpty(this)",
                      "modelLink": "models.resolve['proto_contacts']"
                    }
                  ]
                },
                "confirm": {
                  "text": "Нажмите \"Да\", если Вы уверены в совершаемом действии. Или \"Нет\", если ещё хотите обдумать совершаемое действие.",
                  "title": "Предупреждение",
                  "okLabel": "Да",
                  "cancelLabel": "Нет"
                },
                "title": "Удалить"
              }
            ]
          }
        ]
      },
      "actions": {
        "create": {
          "id": "create",
          "src": "perform",
          "options": {
            "type": "n2o/modals/INSERT",
            "payload": {
              "name": "proto_patients_contacts_create",
              "pageId": "proto_patients_contacts_create",
              "pageUrl": "/proto/patients/:proto_patients_id/contacts/create",
              "pathMapping": {
                "proto_patients_id": {
                  "link": "models.resolve['proto_patients'].id"
                }
              },
              "queryMapping": {},
              "closeButton": true,
              "visible": true
            }
          }
        },
        "update": {
          "id": "update",
          "src": "perform",
          "options": {
            "type": "n2o/modals/INSERT",
            "payload": {
              "name": "proto_patients_contacts_update",
              "pageId": "proto_patients_contacts_update",
              "pageUrl": "/proto/patients/:proto_patients_id/contacts/:proto_contacts_id/update",
              "pathMapping": {
                "proto_patients_id": {
                  "link": "models.resolve['proto_patients'].id"
                },
                "proto_contacts_id": {
                  "link": "models.resolve['proto_contacts'].id"
                }
              },
              "queryMapping": {},
              "closeButton": true,
              "visible": true
            }
          }
        },
        "delete": {
          "id": "delete",
          "src": "perform",
          "options": {
            "type": "n2o/actionImpl/START_INVOKE",
            "payload": {
              "widgetId": "proto_contacts",
              "dataProvider": {
                "url": "n2o/data/proto/patients/:proto_patients_id/contacts/:proto_contacts_id/delete",
                "pathMapping": {
                  "proto_contacts_id": {
                    "link": "models.resolve['proto_contacts'].id"
                  },
                  "proto_patients_id": {
                    "link": "models.resolve['proto_patients'].id"
                  }
                },
                "method": "POST"
              },
              "modelLink": "models.resolve['proto_contacts']"
            },
            "meta": {
              "success": {
                "refresh": {
                  "type": "widget",
                  "options": {
                    "widgetId": "proto_contacts"
                  }
                }
              },
              "fail": {}
            }
          }
        }
      },
      "dependency": {
        "fetch": [
          {
            "on": "models.resolve['proto_patients']"
          }
        ]
      },
      "paging": {
        "size": 10
      },
      "filter": {
        "filterFieldsets": [
          {
            "src": "StandardFieldset",
            "rows": [
              {
                "cols": [
                  {
                    "fields": [
                      {
                        "id": "type",
                        "src": "StandardField",
                        "label": "Тип контакта",
                        "help": "Тип контакта",
                        "dependency": [],
                        "control": {
                          "valueFieldId": "id",
                          "labelFieldId": "name",
                          "hasSearch": false,
                          "data": [
                            {
                              "name": "Моб. телефон",
                              "id": 2
                            },
                            {
                              "name": "Эл. почт",
                              "id": 4
                            },
                            {
                              "name": "Факс",
                              "id": 7
                            }
                          ],
                          "multiSelect": false,
                          "hasCheckboxes": false,
                          "resetOnBlur": true,
                          "src": "InputSelect"
                        }
                      }
                    ]
                  }
                ]
              }
            ]
          }
        ],
        "filterButtonId": "filter",
        "blackResetList": [],
        "filterPlace": "top",
        "searchButtons": true,
        "validation": {}
      },
      "table": {
        "fetchOnInit": false,
        "size": 10,
        "autoFocus": true,
        "hasFocus": true,
        "cells": [
          {
            "id": "value",
            "fieldKey": "value",
            "src": "TextCell"
          },
          {
            "id": "typeId",
            "fieldKey": "typeId",
            "src": "TextCell"
          }
        ],
        "headers": [
          {
            "id": "value",
            "label": "Значение",
            "src": "TextTableHeader",
            "sortable": true
          },
          {
            "id": "typeId",
            "label": "Тип",
            "src": "TextTableHeader",
            "sortable": false
          }
        ],
        "sorting": {},
        "hasSelect": true
      }
    },
    "proto_form": {
      "src": "FormWidget",
      "dataProvider": {
        "url": "n2o/data/proto/patients/:patient_id/card",
        "pathMapping": {
          "patient_id": {
            "link": "models.resolve['proto_patients'].id"
          }
        },
        "queryMapping": {}
      },
      "actions": {},
      "dependency": {
        "fetch": [
          {
            "on": "models.resolve['proto_patients']"
          }
        ]
      },
      "form": {
        "fieldsets": [
          {
            "src": "StandardFieldset",
            "rows": [
              {
                "cols": [
                  {
                    "fields": [
                      {
                        "id": "surname",
                        "src": "StandardField",
                        "label": "Фамилия",
                        "dependency": [],
                        "control": {
                          "src": "InputText"
                        }
                      }
                    ]
                  },
                  {
                    "fields": [
                      {
                        "id": "name",
                        "src": "StandardField",
                        "label": "Имя",
                        "dependency": [],
                        "control": {
                          "src": "InputText"
                        }
                      }
                    ]
                  }
                ]
              },
              {
                "cols": [
                  {
                    "fields": [
                      {
                        "id": "gender",
                        "src": "StandardField",
                        "enabled": false,
                        "label": "Пол",
                        "dependency": [],
                        "control": {
                          "valueFieldId": "id",
                          "labelFieldId": "name",
                          "hasSearch": false,
                          "size": 30,
                          "dataProvider": {
                            "url": "n2o/data/ProtoGender",
                            "queryMapping": {},
                            "quickSearchParam": "name"
                          },
                          "type": "n2o",
                          "src": "RadioGroup"
                        }
                      }
                    ],
                    "size": 8
                  },
                  {
                    "fields": [
                      {
                        "id": "vip",
                        "src": "StandardField",
                        "enabled": false,
                        "dependency": [],
                        "control": {
                          "label": "VIP",
                          "src": "Checkbox"
                        }
                      }
                    ]
                  }
                ]
              }
            ]
          }
        ],
        "validation": {},
        "modelPrefix": "resolve",
        "fetchOnInit": false
      }
    }
  },
  "toolbar": {
    "topRight": [
      {
        "id": "topRight0",
        "buttons": [
          {
            "id": "create2",
            "icon": "fa fa-plus",
            "actionId": "create2",
            "hint": "Добавить пациента",
            "conditions": {},
            "color": "primary",
            "title": "Добавить пациента"
          }
        ]
      }
    ]
  },
  "breadcrumb": [
    {
      "label": "Список контактов",
      "pathMapping": {}
    }
  ],
  "actions": {
    "create2": {
      "id": "create2",
      "src": "link",
      "options": {
        "path": "/proto/create2",
        "target": "application",
        "pathMapping": {},
        "queryMapping": {}
      }
    }
  },
  "models": {},
  "layout": {
    "src": "LeftRightLayout",
    "regions": {
      "left": [
        {
          "src": "PanelRegion",
          "hasTabs": false,
          "headerTitle": "Данные пациента",
          "open": true,
          "collapsible": false,
          "fullScreen": false,
          "panels": [
            {
              "id": "panel1",
              "label": "Пациенты",
              "opened": true,
              "widgetId": "proto_patients"
            }
          ]
        }
      ],
      "right": [
        {
          "src": "PanelRegion",
          "hasTabs": false,
          "headerTitle": "Контакты",
          "open": true,
          "collapsible": true,
          "fullScreen": false,
          "panels": [
            {
              "id": "panel1",
              "label": "Контакты",
              "opened": true,
              "widgetId": "proto_contacts"
            }
          ]
        },
        {
          "src": "PanelRegion",
          "hasTabs": false,
          "headerTitle": "Карточка",
          "open": true,
          "collapsible": true,
          "fullScreen": false,
          "panels": [
            {
              "id": "panel1",
              "opened": true,
              "widgetId": "proto_form"
            }
          ]
        }
      ]
    }
  },
  "page": {
    "title": "Список контактов"
  }
}